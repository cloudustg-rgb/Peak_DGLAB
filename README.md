# Peak X DGLab (Beta)

> **⚠️ 警告 / WARNING**
>
> 1. **本代码完全由 AI 生成**：代码逻辑可能不够优化，或者包含未预见的错误。
> 2. **测试版本 (Beta)**：目前处于早期测试阶段，可能会出现未知 Bug。
> 3. **存档安全**：使用前**请务必做好存档备份**！可使用检查点等其他模组，作者不对任何存档损坏负责。
> 4. **功能限制**：部分功能（如能量条反馈）已知不可用或存在问题。

---

## 项目简介
> **“解决了爬山时感受不到酸痛的问题 (bushi”**
> 
**PEAK X DGLAB (PeakDGLab)** 是一个基于 [BepInEx](https://github.com/BepInEx/BepInEx) 开发的 Unity MOD，专为游戏 **PEAK** 设计。
本项目 Fork 自 [AliceInCradle_X_DGLAB](https://github.com/sllying/AliceInCradle_X_DGLAB)，使用 [DG-Lab-Coyote-Game-Hub](https://github.com/hyperzlib/DG-Lab-Coyote-Game-Hub) 提供的 API 实现游戏与郊狼 (DGLab) 的联动。

---

## 📋 功能介绍

本插件通过读取游戏内的实时数据，根据角色的生理状态和环境互动，向郊狼设备发送不同强度的反馈。所有参数均可在游戏内实时调整。

### 1. 核心生理反馈
* **体力反馈**：当**体力值**下降时，强度会逐渐升高。支持切换体力曲线及最大强度。
* **能量消耗**：(测试中) 使用消耗额外能量时，触发瞬时的电击反馈。

### 2. 全面的异常状态支持
能够识别多种负面状态并叠加电击强度，让你切身体会角色的痛苦：
* **已支持**：困倦 / 寒冷 / 过热 / 中毒 / 刺痛 / 诅咒 / 饥饿 

### 3. 沉浸式情境互动
* **死亡惩罚**：角色死亡时触发持续的强反馈惩罚（可配置强度与持续时间）。
* **失控摔倒**：当角色摔倒时(被风吹走时，触发额外的摔倒反馈(可自定义强度)。
* **昏迷反馈**：角色昏迷时反馈自动归零，也可以自行配置。

### 4. 系统与联机功能
* **感同身受**：(测试中)观战模式下，可同步队友的身体状态进行震动（需手动开启 `观战_感同身受`）。
* **实时控制**：按 **F10** 呼出菜单实时调整参数；按 **P** 键一键启停。

---

## 已知问题 (Known Issues)

在使用前请知悉以下问题：

* ❌ **能量条反馈不可用**：目前能量条（SP/Energy）消耗对应的强度转换功能无法正常工作，请暂时忽略该配置项。
* ❓ **感同身受功能未完全测试**：观战模式下的震动同步功能（感同身受）尚未经过充分测试，可能存在不同步或无反应的情况。
---

## 使用教程

### MOD 安装教程
1. **下载**：下载本 MOD 的 Release 压缩包。
2. **解压**：将压缩包内的PeakDGLab文件夹中的所有内容：复制到**PEAK** 的根目录下。(*根目录就是能看到 `PEAK.exe` 的那个文件夹。*)
3. **启动**：直接运行 `PEAK.exe` 启动游戏即可（首次启动需再次重启以便BepInEx安装）。

---

### 链接郊狼教程

1. 下载并启动 [DG-Lab-Coyote-Game-Hub](https://github.com/hyperzlib/DG-Lab-Coyote-Game-Hub)。
2. 使用郊狼 APP 扫码，确保手机和电脑在同一网络环境下，并连接成功。(也可使用蓝牙直连)

### 游戏内配置

1. 进图后按 **F10** 键，可打开/关闭可视化配置菜单。
2. 按 **P** 键可快速开启/切断电击输出（总开关）。

---

## 配置文件说明

首次运行游戏后，配置文件会在 `BepInEx/config/PeakDGLab.cfg` (或类似名称) 生成。你也可以直接通过游戏内的 **F10** 面板进行实时修改。
首次运行后，配置文件生成于 `BepInEx/config/PeakDGLab.cfg`。

```code
## Settings file was created by plugin PEAK X DGLAB v1.0.0
## Plugin GUID: com.user.peak.dglab

[1. 体力]
## 体力耗尽时的震动强度。
空体力最大强度 = 60
## 1为线性，可改为2。
体力曲线 = 2

[2. 能量]
## SP消耗时的震动。
能量刺痛倍率（目前不可用） = 1

[3. 异常]
## 权重说明：当异常状态值满时增加对应强度的震动
权重: 困倦(当困倦值满时增加10点强度，其他同理) = 10
权重: 寒冷 = 20
权重: 过热 = 20
权重: 中毒 = 50
权重: 刺痛 = 30
权重: 诅咒 = 40
权重: 饥饿 = 15

[4. 特殊]
昏迷_强度倍率 = 0
死亡_惩罚强度 = 100
## 单位为秒
死亡_惩罚持续时间 = 30
## 可选: Smooth (平滑衰减), Instant (立即停止)
死亡_结束方式 = Smooth
## 当角色处于摔倒/失控(Ragdoll)状态时的额外附加震动。
摔倒惩罚强度 = 10

[5. 系统]
## 紧急停止开关。
总开关_启用电击 = true
## 观战时是否同步队友的状态进行震动。
观战_感同身受 = false
## 快捷键设置
快捷键_电击开关 = P
快捷键_设置菜单 = F10

[6. 内部]
刷新间隔(ms) = 100
自然衰减速度 = 2
启用调试日志 = true
```

> **提示**：请谨慎修改强度。

---

## 声明与致谢

* **Original Project**: Forked from [AliceInCradle_X_DGLAB](https://github.com/sllying/AliceInCradle_X_DGLAB) by sllying.
* **License**: MIT License (遵循原项目协议).
* **Disclaimer**: 本插件为第三方修改版本，与游戏官方及原插件作者无关。本代码完全由 AI 辅助生成。

---

**再次提醒：请务必备份你的存档！**
